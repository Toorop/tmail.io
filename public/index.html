<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>tmail &middot; Journal de développement d&#39;un serveur SMTP</title>

  
  <link rel="stylesheet" href="http://localhost:1313//css/poole.css">
  <link rel="stylesheet" href="http://localhost:1313//css/hyde.css">
  <link rel="stylesheet" href="http://localhost:1313//css/hyde-x.css">
  <link rel="stylesheet" href="http://localhost:1313//css/tmail.css">
   
    <link rel="stylesheet" href="http://localhost:1313//libs/plyr/plyr.css">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900,300italic,400italic,700italic,900italic">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link href="/favicon.png" rel="icon">

  
  <link href="http://localhost:1313/index.xml" rel="alternate" type="application/rss+xml" title="tmail &middot; Stéphane Depierrepont" />

  <meta name="description" content="Journal de développement d&#39;un serveur SMTP">
  <meta name="keywords" content="[tmail smtp develloppement golang]">
  <link rel="author" href="http://plus.google.com/&#43;St%C3%A9phaneDepierrepont">
</head>
<body>
 <ul class="navigation">
    <li class="nav-item"><a href="/">Home</a> </li>
    
    <li class="nav-item"><a href="/changelog/"> Changelog </a>
    </li>
    
    <li class="nav-item"><a href="/wishlist/"> Wishlist </a>
    </li>
    
    <li class="nav-item"><a href="/faq/"> Faq </a>
    </li>
    
    <li class="nav-item"><a href="/recherche/"> Rechercher </a>
    </li>
    
    <li class="nav-item"><a href="/podcast/">Podcast</a>
    </li>
    <li class="nav-item"><a href="/index.xml" target="_blank"> RSS </a>
    </li>
    <li class="nav-item"><a href="mailto:toorop@toorop.fr"> Contact </a>
    </li>
</ul>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger"></label>


<div class="site-wrap">
    <div class="topbar">
  <div class="color-overlay"></div>
  <div class="container">
    <div class="title">
      <h1>tmail</h1>
      <h4>Journal de développement d&#39;un serveur SMTP</h4>
    </div>
  </div>
</div>

    <div class="content container">
        <div class="posts">
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/doc/mailboxes/">Gérez vos boites mail avec tmail et Dovecot</a>
      </h1>
                <span class="post-date">Mar 18, 2015 &middot; Temps de lecture: 9 min  &middot; <a href="http://localhost:1313/doc/mailboxes/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/doc">doc</a>
      </span>
                <p><p>Initialement j&rsquo;avais prévu d&rsquo;ajouter le support de comptes mail bien plus tard dans le cycle de développement car mon usage principal de tmail est avant tout celui de relais SMTP.<br />
Le fait que l&rsquo;on m&rsquo;ait demandé si ça allait être bientôt disponible m&rsquo;a fait réaliser que gérer des comptes mails était quand même l&rsquo;usage principal d&rsquo;un serveur de messagerie, j&rsquo;ai donc décidé de remonter cette tache dans ma todo-list.</p>

<p>Pour vous proposer cette fonctionnalité plus rapidement, j&rsquo;ai fait quelques compromis par rapport à ce que je voulais initialement faire. Mon idée de départ était de ne pas utiliser le classique stockage des mails via Mailbox/maildir + accès POP ou IMAP, mais d’utiliser une simple <strong>interface de stockage de type PUT/GET pour stocker les mails et une API HTTP REST pour y accéder et les gérer.</strong></p>

<p>L’intérêt de cette solution c&rsquo;est que l&rsquo;on peut implémenter l&rsquo;interface pour une multitude de types de stockage &ldquo;physique&rdquo;, du simple espace disque sur le serveur, ou déporté sur un NAS/Filer, mais aussi du Amazon S3, ou plus proche de nous du Runabove.
Par ailleurs proposer une API REST pour gérer les mails permettait de développer simplement des clients de messagerie adaptés et pourquoi pas des &ldquo;connecteurs/proxy&rdquo; pour rendre ce stockage compatible avec les clients classique (par exemple un proxy IMAP).</p>

<p>Rassurez vous - ou pas - je n&rsquo;ai pas abandonné ces idées, ce sera implémenté, mais en attendant pour offrir le plus rapidement la possibilité d&rsquo;utiliser tmail comme serveur mail classique, j&rsquo;ai décidé de prendre un raccourcis en implémentant le nécessaire pour utiliser Dovecot avec tmail.</p>

<p><strong>Concrètement il est donc aujourd&rsquo;hui possible d&rsquo;utiliser tmail comme serveur de destination pour un domaine - celui qui va héberger les mails du domaine donc - et d&rsquo;accéder aux boites mails via POP et IMAP.</strong></p>

<p>Voila pour cette - longue - introduction, passons à la pratique.</p>
</p>
                <a href="http://localhost:1313/doc/mailboxes/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/podcast/3/">Podcast #3: Nouvelle rubrique</a>
      </h1>
                <span class="post-date">Mar 14, 2015 &middot; Temps de lecture: 1 min  &middot; <a href="http://localhost:1313/podcast/3/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/podcast">podcast</a>
      </span>
                <p><p>Les nouvelles du projet, avec cette semaine, des corrections de bugs, du refactoring et&hellip; une nouvelle rubrique.
<div class="player">
    <audio controls preload="none">
        &lt;!&ndash; Audio files &ndash;&gt;
        <source src="http://podcasts.toorop.fr/tmail/ep3-2.mp3" type="audio/mp3">
        &lt;!&ndash; Fallback for browsers that don&rsquo;t support the <audio> element &ndash;&gt;
        <div>
            <a href="http://podcasts.toorop.fr/tmail/ep3-2.mp3">Download</a>
        </div>
    </audio>
</div>
<br></p>
</p>
                <a href="http://localhost:1313/podcast/3/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/podcast/episode-2/">Podcast #2: Toc toc...</a>
      </h1>
                <span class="post-date">Mar 6, 2015 &middot; Temps de lecture: 1 min  &middot; <a href="http://localhost:1313/podcast/episode-2/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/podcast">podcast</a>
      </span>
                <p><p>Dans cet épisode je vais vous parler des suggestions qui m&rsquo;ont été faites concernant les fonctionnalités de tmail.
<div class="player">
    <audio controls preload="none">
        &lt;!&ndash; Audio files &ndash;&gt;
        <source src="//podcasts.toorop.fr/tmail/enclosures/tmail-devcast-ep2.mp3" type="audio/mp3">
        &lt;!&ndash; Fallback for browsers that don&rsquo;t support the <audio> element &ndash;&gt;
        <div>
            <a href="//podcasts.toorop.fr/tmail/enclosures/tmail-devcast-ep2.mp3">Download</a>
        </div>
    </audio>
</div>
<br></p>
</p>
                <a href="http://localhost:1313/podcast/episode-2/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/podcast/episode-1-antivirus/">Podcast #1: Antivirus</a>
      </h1>
                <span class="post-date">Feb 24, 2015 &middot; Temps de lecture: 1 min  &middot; <a href="http://localhost:1313/podcast/episode-1-antivirus/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/podcast">podcast</a>
      </span>
                <p><p>Dans cet épisode je vais vous parler de l&rsquo;intégration du filtrage antivirus au sein de tmail en utilisant le scanner opensource Clamav.
<div class="player">
    <audio controls preload="none">
        &lt;!&ndash; Audio files &ndash;&gt;
        <source src="//podcasts.toorop.fr/tmail/enclosures/ep1.mp3" type="audio/mp3">
        &lt;!&ndash; Fallback for browsers that don&rsquo;t support the <audio> element &ndash;&gt;
        <div>
            <a href="http://podcasts.toorop.fr/tmail/enclosures/ep1.mp3">Download</a>
        </div>
    </audio>
</div>
<br></p>
</p>
                <a href="http://localhost:1313/podcast/episode-1-antivirus/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/podcast/episode-0/">Podcast #0: Présentations</a>
      </h1>
                <span class="post-date">Feb 23, 2015 &middot; Temps de lecture: 1 min  &middot; <a href="http://localhost:1313/podcast/episode-0/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/podcast">podcast</a>
      </span>
                <p><p>Dans cet épisode je vais me présenter, vous présenter le projet de serveur SMTP tmail et la raison d&rsquo;etre de ce podcast.
<div class="player">
    <audio controls preload="none">
        &lt;!&ndash; Audio files &ndash;&gt;
        <source src="http://podcasts.toorop.fr/tmail/enclosures/episode0.mp3" type="audio/mp3"></p>

<pre><code>    &lt;!-- Fallback for browsers that don't support the &lt;audio&gt; element --&gt;
    &lt;div&gt;
        &lt;a href=&quot;http://podcasts.toorop.fr/tmail/enclosures/episode0.mp3&quot;&gt;Download&lt;/a&gt;
    &lt;/div&gt;
&lt;/audio&gt;
</code></pre>

<p></div>
<br></p>
</p>
                <a href="http://localhost:1313/podcast/episode-0/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/doc/filtrage-smtp-antivirus-clamav/">Filtrage antivirus en utilisant Clamav</a>
      </h1>
                <span class="post-date">Feb 18, 2015 &middot; Temps de lecture: 2 min  &middot; <a href="http://localhost:1313/doc/filtrage-smtp-antivirus-clamav/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/doc">doc</a>
      </span>
                <p><p>Vous trouverez dans ce billet les explications nécessaires pour installer l&rsquo;antivirus opensource <a href="http://www.clamav.net/index.html">Clamav</a> et activer le filtrage de votre flux SMTP par tmail.</p>
</p>
                <a href="http://localhost:1313/doc/filtrage-smtp-antivirus-clamav/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/doc/installer-tmail/">Installer et configurer tmail</a>
      </h1>
                <span class="post-date">Jan 29, 2015 &middot; Temps de lecture: 9 min  &middot; <a href="http://localhost:1313/doc/installer-tmail/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/doc">doc</a>
      </span>
                <p><p><br>
<div style="text-align:center">
<iframe align="center" width="640" height="360" src="https://www.youtube.com/embed/Ncs3AZKPqKU?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
<br></p>

<p>Durant tout le cycle de développement de tmail je vais mettre à disposition le nécessaire pour qu&rsquo;il soit possible de tester les fonctionnalités qui sont implémentées.</p>

<p>Qu&rsquo;il n&rsquo;y ait pas de malentendu, on ne parle pas ici de version bêta, ni même alpha, ce sera à chaque fois une version de développement, avec plein de choses non implémentées et forcement de nombreux bugs.</p>

<p><strong>En clair: ne pas utiliser en production</strong></p>

<p>Pour le moment tmail est très basique, mais il devrait cependant vous permettre d&rsquo;envoyer et de relayer des mails.</p>
</p>
                <a href="http://localhost:1313/doc/installer-tmail/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/doc/cli-gestion-route-smtp/">Gestion des routes SMTP en utilisant le CLI</a>
      </h1>
                <span class="post-date">Jan 28, 2015 &middot; Temps de lecture: 4 min  &middot; <a href="http://localhost:1313/doc/cli-gestion-route-smtp/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/doc">doc</a>
      </span>
                <p><p>Vous pouvez gérer les routes SMTP sortantes directement en ligne de commande, ce document vous donne les références concernant les fonctionnalités implémentées.</p>

<p>Avant d&rsquo;aller plus loin je vous recommande la lecture de la <a href="/doc/routes-smtp-sortantes/">documentation expliquant le fonctionnement des routes SMTP</a> principalement pour savoir l&rsquo;ordre dans lequel les règles sont testées. Il faut savoir que la première route qui correspond sera celle qui sera utilisée, donc si vous ne voulez pas avoir de surprise il est capital de bien assimiler ce point.</p>
</p>
                <a href="http://localhost:1313/doc/cli-gestion-route-smtp/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/doc/cli-gestion-queue/">Gestion de la queue en utilisant le CLI</a>
      </h1>
                <span class="post-date">Jan 21, 2015 &middot; Temps de lecture: 2 min  &middot; <a href="http://localhost:1313/doc/cli-gestion-queue/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/doc">doc</a>
      </span>
                <p><h4 id="lister-les-messages-en-queue:a5ae8842e5f4cb42bab09bbc9c21cead">Lister les messages en queue</h4>

<p>La commande pour lister les messages en queue est:</p>

<pre><code>tmail queue list
</code></pre>

<p>Pour chaque mail en queue les informations suivantes sont retournées:</p>

<ul>
<li>Identifiant du mail en queue</li>
<li>From: expéditeur du mail</li>
<li>To:  destinataire du mail</li>
<li>Status: status du mail. Actuellement les status sont &ldquo;Delivery in progress&rdquo;, &ldquo;Scheduled&rdquo;, &ldquo;Will be discarded&rdquo;, &ldquo;Will be bounced&rdquo;</li>
<li>Next delivery process scheduled at: Dans le cas ou un mail est en attente dans la queue ce paramètre indique le moment (approximatif) où le mail sera représenté au process tmail qui traite les message en queue.</li>
</ul>
</p>
                <a href="http://localhost:1313/doc/cli-gestion-queue/">Lire la suite &rarr;</a>
            </div>
            
            <div class="post">
                <h1 class="post-title">
        <a href="http://localhost:1313/doc/routes-smtp-sortantes/">Routes smtp sortantes</a>
      </h1>
                <span class="post-date">Jan 19, 2015 &middot; Temps de lecture: 2 min  &middot; <a href="http://localhost:1313/doc/routes-smtp-sortantes/#disqus_thread">Comments</a>
      
      <br/>
      
      <a class="label" href="http://localhost:1313//categories/doc">doc</a>
      </span>
                <p><p><strong>tmail vous permet de spécifier des routes sortantes pour les mails qu&rsquo;il a à expédier.</strong></p>

<p>Par défaut, lorsque tmail doit transmettre un mail il va faire une requête DNS MX pour obtenir les adresses IP du/des serveur(s) SMTP du domaine de destination. C&rsquo;est le fonctionnement classique d&rsquo;un serveur SMTP, mais vous pouvez aussi créer des règles de routage pour forcer les connexions sortantes vers des relais spécifiques.</p>
</p>
                <a href="http://localhost:1313/doc/routes-smtp-sortantes/">Lire la suite &rarr;</a>
            </div>
            
        </div>
    </div>
</div>


<script>
(function(d, p) {
    var a = new XMLHttpRequest(),
        b = d.body;
    a.open("GET", p, !0);
    a.send();
    a.onload = function() {
        var c = d.createElement("div");
        c.style.display = "none";
        c.innerHTML = a.responseText;
        b.insertBefore(c, b.childNodes[0])
    }
})(document, "http:\/\/localhost:1313\//libs/plyr/sprite.svg");
</script>


<script src="http://localhost:1313//libs/plyr/plyr.js"></script> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-59890382-1', 'auto');
  ga('send', 'pageview');
</script>
<script src="http://localhost:1313//js/tmail.js"></script>
<script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

